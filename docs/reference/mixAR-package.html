<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mixture Autoregressive Models — mixAR-package • mixAR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Mixture Autoregressive Models — mixAR-package" />
<meta property="og:description" content="Model time series using mixture autoregressive (MAR)
             models.  Implemented are frequentist (EM) and Bayesian
             methods for estimation, prediction and model
             evaluation. See Wong and Li (2002)
             &amp;lt;doi:10.1111/1467-9868.00222&amp;gt;, Boshnakov (2009)
             &amp;lt;doi:10.1016/j.spl.2009.04.009&amp;gt;), and the extensive
             references in the documentation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mixAR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.22.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GeoBosh/mixAR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mixture Autoregressive Models</h1>
    
    <div class="hidden name"><code>mixAR-package.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Model time series using mixture autoregressive (MAR)
             models.  Implemented are frequentist (EM) and Bayesian
             methods for estimation, prediction and model
             evaluation. See Wong and Li (2002)
             &lt;doi:10.1111/1467-9868.00222&gt;, Boshnakov (2009)
             &lt;doi:10.1016/j.spl.2009.04.009&gt;), and the extensive
             references in the documentation.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><!-- % \tabular{ll}{ -->
  <!-- %   Package:  \tab \Sexpr[stage=build]{pd$Package}\cr -->
  <!-- %   Type:     \tab \Sexpr[stage=build]{pd$Type}\cr -->
  <!-- %   Version:  \tab \Sexpr[stage=build]{pd$Version} \cr -->
  <!-- %   Date:     \tab \Sexpr[stage=build]{pd$Date}\cr -->
  <!-- %   License:  \tab \Sexpr[stage=build]{pd$License}\cr -->
  <!-- %   LazyLoad: \tab \Sexpr[stage=build]{pd$LazyLoad}\cr -->
  <!-- %   Built:    \tab \Sexpr[stage=build]{pd$Built}\cr -->
  <!-- % } -->
  <!-- %  -->
  <!-- % Index: -->
  <!-- % -->
  <!-- % \Sexpr[stage=build,results=rd]{paste("\\\\preformatted{", paste(if(!is.null(lb$info[[2]])) lb$info[[2]] else "No entries",collapse="\n"), "}", sep="")} --></p>

<p><!-- %\strong{Index:} --></p>
<p><!-- %%%%   Below is an attempt to group related topics in clusters. This is for -->
<!-- %%%%   development purposes. It is easy to edit this, including adding and -->
<!-- %%%%   removing clusters, see the source of this help page. Note that the -->
<!-- %%%%   last, "Rest", contains all topics that are not included in any of the -->
<!-- %%%%   other clusters. This is to make visible forgotten topics. To prevent a -->
<!-- %%%%   topic appearing in "Rest", add it to cluster "ignore", which is just -->
<!-- %%%%   before "Rest" in the Rd source. -->
<!-- %%%%  -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{alltopics &lt;- unique(gsub("^(([^ ]+)[^ ]*|(^[ ]))(.*)", "\\\\1", lb$info[[2]]))} -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{alltopics &lt;- alltopics[!grepl("^ ", alltopics)]} -->
<!-- %%%%  -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- list()} -->
<!-- %%%%  -->
<!-- %%%%  -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(mixAR = -->
<!-- %%%%     c("^mixAR-class", "^MixARGaussian-class", "^mixARgen-class", -->
<!-- %%%%     "^mixAR-methods", "^show_diff-methods", "^parameters-methods" )))} -->
<!-- %%%%   \subsection{mixAR classes}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["mixAR"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(estimation = -->
<!-- %%%%     c("^fit_mixAR", "^mixARreg", "^mixSARfit", "^mix_se-methods" -->
<!-- %%%%       )))} -->
<!-- %%%%   \subsection{mixAR estimation}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["estimation"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(likelihood = -->
<!-- %%%%     c("^est_templ", "^cond_loglik", "^make_fcond_lik-methods"  )))} -->
<!-- %%%%   \subsection{mixAR likelihood}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["likelihood"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%  -->
<!-- %%%%   % "^mix_kurtosis", "^mix_variance-methods", -->
<!-- %%%%   % "^mix_moment-methods", "^mix_location-methods", "^mix_central_moment-methods", -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(mixARdist = -->
<!-- %%%%     c("^mix_pdf-methods", "^mix_moment", "^multiStep_dist-methods"   )))} -->
<!-- %%%%   \subsection{mixAR distributions}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["mixARdist"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%  -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(dataandsim = c( -->
<!-- %%%%     "^exampleModels", "^mixARnoise_sim", "^mixAR_sim", -->
<!-- %%%%      "^randomArCoefficients")))} -->
<!-- %%%%   \subsection{Data and simulation}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["dataandsim"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%  -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(mixFilter = -->
<!-- %%%%     c("^mixFilter", "^raghat1" )))} -->
<!-- %%%%   \subsection{mixFilter}{ -->
<!-- %%%%     Please use whenever possible these functions, instead of programming -->
<!-- %%%%     the nested loops from scratch. This leads to more reliable code and -->
<!-- %%%%     easy maintenance. For example the functions may be replaced by -->
<!-- %%%%     C-code without ttouching any cother code. -->
<!-- %%%%      -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["mixFilter"]])} -->
<!-- %%%%   } -->
<!-- %%%%    -->
<!-- %%%%  -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(MixComp = -->
<!-- %%%%     c("^MixComp-class", "^mix_ncomp-methods", "^mix_ek-methods", -->
<!-- %%%%     "^mix_hatk-methods", "^\%of\%", "^inner", "^row_lengths"  )))} -->
<!-- %%%%   \subsection{MixComp}{ -->
<!-- %%%%     Convenient computing with mixAR time series. -->
<!-- %%%%      -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["MixComp"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(em = -->
<!-- %%%%     c("^em_[^ ]", "^tau2probhat", "^mixMstep", "^mixgenMstep", -->
<!-- %%%%     "^mixARemFixedPoint", "^mixAR_cond_probs", "^mixSubsolve" )))} -->
<!-- %%%%   \subsection{EM}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["em"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(parameters = -->
<!-- %%%%     c("^parameters", "^lik_params", "^predict_coef", -->
<!-- %%%%     "^tomarparambyComp", "^mixAR_switch", "^isStable", -->
<!-- %%%%     "^[.]can[^ ]*" )))} -->
<!-- %%%%   \subsection{Parameters}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["parameters"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(raggedCoef  = -->
<!-- %%%%   c("^raggedCoef", "^rag_modify", "^ragged2char" )))} -->
<!-- %%%%   \subsection{raggedCoef}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["raggedCoef"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(Bayesian = -->
<!-- %%%%     c("^bayes_mixAR", "^bx_dx", "^Choose_pk", "^err", "^label_switch", -->
<!-- %%%%     "^sampZpi", "^sampMuShift", "^sampMuShift", "^sampSigmaTau", "^marg_loglik")))} -->
<!-- %%%%   \subsection{Bayesian}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["Bayesian"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(mixARnoise = -->
<!-- %%%%     c("^dist_norm", "^fnoise", "^get_edist[^ ]", "^noise[^ ]", "^stdnormmoment")))} -->
<!-- %%%%   \subsection{mixAR noise}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(pat[["mixARnoise"]])} -->
<!-- %%%%   } -->
<!-- %%%%  -->
<!-- %%%%    -->
<!-- %%%%   % \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(internal = c("^[.]can[^ ]*")))} -->
<!-- %%%%   % \subsection{Internal}{ -->
<!-- %%%%   %   \Sexpr[stage=build,results=rd]{lbpaste(pat[["internal"]])} -->
<!-- %%%%   % } -->
<!-- %%%%  -->
<!-- %%%%   %% these are ignored, i.e. not printed anywhere -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{pat &lt;- c(pat, list(ignore = -->
<!-- %%%%   c("^mixAR-package", "^initialize-methods")))} -->
<!-- %%%%    -->
<!-- %%%%   \Sexpr[stage=build,results=hide]{rest &lt;- alltopics[!grepl( paste0("(", paste0(unlist(pat),collapse=")|("), ")"),alltopics)]} -->
<!-- %%%%   \subsection{rest}{ -->
<!-- %%%%     \Sexpr[stage=build,results=rd]{lbpaste(rest)} -->
<!-- %%%%   } --></p>

<p><!-- % An overview of how to use the package, including the most important functions --></p>
<p>Package <span class="pkg">mixAR</span> provides functions for modelling with mixture
  autoregressive (MixAR) models. The S4 class <code>"MixARGaussian"</code> can
  be used when the error distributions of the components are standard
  Gaussian. The class <code>"MixARgen"</code> admits arbitrary (well, within
  reason) distributions for the error components. Both classes inherit
  from the virtual class <code>"MixAR"</code>.</p>
<p>Estimation can be done with <code>fit_mixAR</code>.  Currently, the EM
  algorithm is used for estimation.</p>
<p>For <code>"MixARGaussian"</code> the M-step of the EM algorithm reduces to a
  system of linear equations. For <code>"MixARgen"</code> the problem is
  substantially non-linear. The implementation is fairly general but
  currently not optimised for efficiency. The specification of the error
  distributions went through several stages and may still be
  reviewed. However, backward compatibility will be kept.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Akinyemi MI (2013).
<em>Mixture autoregressive models: asymptotic properties and application to
                  financial risk</em>.
Ph.D. thesis, Probability and Statistics Group, School of Mathematics, University of
            Manchester.</p>
<p>Boshnakov GN (2009).
&#8220;Analytic expressions for predictive distributions in mixture
    autoregressive models.&#8221;
<em>Stat. Probab. Lett. </em>, <b>79</b>(15), 1704-1709.
doi: <a href='https://doi.org/10.1016/j.spl.2009.04.009'>10.1016/j.spl.2009.04.009</a>
.</p>
<p>Boshnakov GN (2011).
&#8220;On First and Second Order Stationarity of Random Coefficient Models.&#8221;
<em>Linear Algebra Appl.</em>, <b>434</b>(2), 415--423.
doi: <a href='https://doi.org/10.1016/j.laa.2010.09.023'>10.1016/j.laa.2010.09.023</a>
.</p>
<p>Fong P, Li W, Yau C, Wong C (2007).
&#8220;On a mixture vector autoregressive model.&#8221;
<em>Can. J. Stat. </em>, <b>35</b>(1), 135-150.</p>
<p>Ravagli D, Boshnakov GN (2020).
&#8220;Portfolio optimization with mixture vector autoregressive models.&#8221;
2005.13396, <a href='https://arxiv.org/abs/2005.13396'>https://arxiv.org/abs/2005.13396</a>.</p>  
<p>Hossain AS (2012).
<em>Complete Bayesian analysis of some mixture time series models</em>.
Ph.D. thesis, Probability and Statistics Group, School of Mathematics, University of
                Manchester.</p>
<p>Wong CS (1998).
<em>Statistical inference for some nonlinear time series models</em>.
Ph.D. thesis, University of Hong Kong, Hong Kong .</p>
<p>Wong CS, Li WK (2000).
&#8220;On a mixture autoregressive model.&#8221;
<em>J. R. Stat. Soc., Ser. B, Stat. Methodol. </em>, <b>62</b>(1), 95-115.</p>
<p>Wong CS, Li WK (2001).
&#8220;On a logistic mixture autoregressive model.&#8221;
<em>Biometrika </em>, <b>88</b>(3), 833-846.
doi: <a href='https://doi.org/10.1093/biomet/88.3.833'>10.1093/biomet/88.3.833</a>
.</p>
<p>Wong CS, Li WK (2001).
&#8220;On a mixture autoregressive conditional heteroscedastic model.&#8221;
<em>J. Am. Stat. Assoc. </em>, <b>96</b>(455), 982-995.
doi: <a href='https://doi.org/10.1198/016214501753208645'>10.1198/016214501753208645</a>
.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## object 'exampleModels' contains a number of models for examples and testing</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>exampleModels</span>)</div><div class='output co'>#&gt;  [1] "WL_ibm"     "WL_A"       "WL_B"       "WL_I"       "WL_II"     
#&gt;  [6] "WL_ibm_gen" "WL_ibm_t3v" "WL_ibm_tf"  "WL_At"      "WL_Bt_1"   
#&gt; [11] "WL_Bt_2"    "WL_Bt_3"    "WL_Ct_1"    "WL_Ct_2"    "WL_Ct_3"   </div><div class='input'><span class='no'>exampleModels</span>$<span class='no'>WL_ibm</span></div><div class='output co'>#&gt; (To see the internal structure of the object, use function 'str'.)
#&gt; 
#&gt; An object of class "MixARGaussian"
#&gt; Number of components: 3 
#&gt;        prob   shift scale   order ar_1   ar_2   
#&gt; Comp_1 0.5439   0    4.8227   2   0.6792  0.3208
#&gt; Comp_2 0.4176   0    6.0082   2   1.6711 -0.6711
#&gt; Comp_3 0.0385   0   18.1716   1   1.0000        
#&gt; 
#&gt; Distributions of the error components:
#&gt; 	standard Gaussian
#&gt; </div><div class='input'>
<span class='co'>## some of the models below are available in object 'exampleModels';</span>
<span class='co'>## the examples here show how to create them from scratch</span>
<span class='no'>mo_WLprob</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5439</span>, <span class='fl'>0.4176</span>, <span class='fl'>0.0385</span>)              <span class='co'># model coefficients from Wong&amp;Li</span>
<span class='no'>mo_WLsigma</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4.8227</span>, <span class='fl'>6.0082</span>, <span class='fl'>18.1716</span>)
<span class='no'>mo_WLar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.6792</span>, <span class='fl'>0.3208</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.6711</span>, -<span class='fl'>0.6711</span>), <span class='fl'>1</span>)

<span class='no'>mo_WL</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARGaussian"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>mo_WLprob</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>mo_WLsigma</span>, <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='no'>mo_WLar</span>)

<span class='no'>mo_WL_A</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARGaussian"</span>                         <span class='co'># WongLi, model A</span>
              , <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>0.5</span>)
              , <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>1</span>)
              , <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>)
              , <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.1</span>))
              )

<span class='no'>mo_WL_B</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARGaussian"</span>                         <span class='co'># WongLi, model B</span>
              , <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.75</span>, <span class='fl'>0.25</span>)
              , <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>1</span>)
              , <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>)
              , <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.4</span>))
              )

<span class='no'>mo_WL_I</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARGaussian"</span>                          <span class='co'># WongLi, model I</span>
              , <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.4</span>, <span class='fl'>0.3</span>, <span class='fl'>0.3</span>)
              , <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>5</span>)
              , <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>, -<span class='fl'>5</span>)
              , <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.9</span>, -<span class='fl'>0.6</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>0.5</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.50</span>, -<span class='fl'>0.74</span>, <span class='fl'>0.12</span>))
              )

<span class='no'>mo_WL_II</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARGaussian"</span>                         <span class='co'># WongLi, model II</span>
               , <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.4</span>, <span class='fl'>0.3</span>, <span class='fl'>0.3</span>)
               , <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>5</span>)
               , <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>0</span>, -<span class='fl'>5</span>)
               , <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.9</span>, -<span class='fl'>0.6</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>0.7</span>, <span class='fl'>0</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>0</span>, <span class='fl'>0.80</span>))
               )

<span class='co'>## MixAR models with arbitrary dist. of the components</span>
<span class='co'>## (user interface not finalized)</span>

<span class='co'>## Gaussian</span>
<span class='no'>mo_WLgen</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARgen"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>mo_WLprob</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>mo_WLsigma</span>, <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='no'>mo_WLar</span>,
               <span class='kw'>dist</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>dist_norm</span>))

<span class='co'>## t_3</span>
<span class='no'>mo_WLt3v</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARgen"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>mo_WLprob</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>mo_WLsigma</span>, <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='no'>mo_WLar</span>,
               <span class='kw'>dist</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='fnoise.html'>fdist_stdt</a></span>(<span class='fl'>3</span>, <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)))

<span class='co'>## t_20, t_30, t_40 (can be used to start estimation)</span>
<span class='no'>mo_WLtf</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARgen"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>mo_WLprob</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>mo_WLsigma</span>, <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='no'>mo_WLar</span>,
              <span class='kw'>dist</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>generator</span> <span class='kw'>=</span>
                              <span class='kw'>function</span>(<span class='no'>par</span>)
                                  <span class='fu'><a href='fnoise.html'>fn_stdt</a></span>(<span class='no'>par</span>, <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>), <span class='kw'>param</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>, <span class='fl'>30</span>, <span class='fl'>40</span>)))

<span class='co'>## data(ibmclose, package = "fma")  # for `ibmclose'</span>

<span class='co'>## The examples below are quick but some of them are marked as 'not run'</span>
<span class='co'>## to avoid cummulative time of more than 5s on CRAN.</span>

<span class='co'>## fit a MAR(2,2,1) model</span>
<span class='no'>a0a</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fit_mixAR-methods.html'>fit_mixAR</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='kw pkg'>fma</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/fma/man/ibmclose.html'>ibmclose</a></span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>1</span>))</div><div class='output co'>#&gt; cond:  37844644 
#&gt; cond:  49346768 
#&gt; cond:  44205436 
#&gt; Initial vallogf:  -1244.823 
#&gt; niter:  25 	vallogf:  -1201.216 
#&gt; niter:  50 	vallogf:  -1201.118 
#&gt; niter:  75 	vallogf:  -1200.91 
#&gt; niter:  100 	vallogf:  -1200.281 
#&gt; niter:  125 	vallogf:  -1200.037 
#&gt; niter:  150 	vallogf:  -1200.02 
#&gt; niter:  175 	vallogf:  -1200.019 
#&gt; niter:  200 	vallogf:  -1200.019 
#&gt; Final niter:  200 	vallogf:  -1200.019 </div><div class='input'><span class='co'>## same with 2 sets of automatically generated initial values.</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>a0b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fit_mixAR-methods.html'>fit_mixAR</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='kw pkg'>fma</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/fma/man/ibmclose.html'>ibmclose</a></span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>1</span>), <span class='fl'>2</span>)
}

<span class='co'>## fix the shift parameters:</span>
<span class='no'>a1a</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fit_mixAR-methods.html'>fit_mixAR</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='kw pkg'>fma</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/fma/man/ibmclose.html'>ibmclose</a></span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>1</span>), <span class='kw'>fix</span> <span class='kw'>=</span> <span class='st'>"shift"</span>)</div><div class='output co'>#&gt; cond:  67949.37 
#&gt; cond:  1709713 
#&gt; cond:  7424.067 
#&gt; Initial vallogf:  -1241.973 
#&gt; niter:  25 	vallogf:  -1213.723 
#&gt; niter:  50 	vallogf:  -1213.478 
#&gt; niter:  75 	vallogf:  -1213.429 
#&gt; niter:  100 	vallogf:  -1213.425 
#&gt; niter:  125 	vallogf:  -1213.424 
#&gt; niter:  150 	vallogf:  -1213.424 
#&gt; niter:  175 	vallogf:  -1213.424 
#&gt; niter:  200 	vallogf:  -1213.424 
#&gt; Final niter:  200 	vallogf:  -1213.424 </div><div class='input'><span class='co'>## ... with 3 sets of automatically generated initial values.</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>a1b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fit_mixAR-methods.html'>fit_mixAR</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='kw pkg'>fma</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/fma/man/ibmclose.html'>ibmclose</a></span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>1</span>), <span class='fl'>3</span>, <span class='kw'>fix</span> <span class='kw'>=</span> <span class='st'>"shift"</span>)
}

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## specify the model using a MixAR model object</span>
<span class='no'>a1c</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fit_mixAR-methods.html'>fit_mixAR</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='kw pkg'>fma</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/fma/man/ibmclose.html'>ibmclose</a></span>), <span class='no'>a1a</span>$<span class='no'>model</span>, <span class='kw'>init</span> <span class='kw'>=</span> <span class='no'>a0a</span>$<span class='no'>model</span>, <span class='kw'>fix</span> <span class='kw'>=</span> <span class='st'>"shift"</span>)

<span class='co'>## fit a model like mo_WL using as initial values 3 automatically generated sets.</span>
<span class='no'>a2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fit_mixAR-methods.html'>fit_mixAR</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='kw pkg'>fma</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/fma/man/ibmclose.html'>ibmclose</a></span>), <span class='no'>mo_WL</span>, <span class='fl'>3</span>, <span class='kw'>fix</span> <span class='kw'>=</span> <span class='st'>"shift"</span>, <span class='kw'>permute</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}

<span class='no'>moT_B3</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARgen"</span>
               , <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.3</span>, <span class='fl'>0.3</span>, <span class='fl'>0.4</span>)
               , <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span>)
               , <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, -<span class='fl'>5</span>, <span class='fl'>0</span>)
               , <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>0.24</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>0.9</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, -<span class='fl'>0.74</span>, <span class='fl'>0.12</span>))
                                        <span class='co'># t4, t4, t10</span>
               , <span class='kw'>dist</span> <span class='kw'>=</span> <span class='fu'><a href='fnoise.html'>distlist</a></span>(<span class='st'>"stdt"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>10</span>), <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>FALSE</span>, <span class='fl'>TRUE</span>), <span class='kw'>tr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>))
               )

<span class='no'>moT_C1</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARgen"</span>
              , <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.3</span>, <span class='fl'>0.3</span>, <span class='fl'>0.4</span>)
              , <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span>)
              , <span class='kw'>shift</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>, -<span class='fl'>5</span>, <span class='fl'>0</span>)
              , <span class='kw'>arcoef</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>0.24</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>0.9</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.5</span>, -<span class='fl'>0.74</span>, <span class='fl'>0.12</span>))
                                        <span class='co'># t4, t7, N(0,1)</span>
              , <span class='kw'>dist</span> <span class='kw'>=</span> <span class='fu'><a href='fnoise.html'>distlist</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"stdt"</span>, <span class='st'>"stdt"</span>, <span class='st'>"stdnorm"</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>7</span>))
              )

<span class='co'>## demonstrate reuse of existing models</span>
<span class='no'>exampleModels</span>$<span class='no'>WL_Bt_1</span></div><div class='output co'>#&gt; (To see the internal structure of the object, use function 'str'.)
#&gt; 
#&gt; An object of class "MixARgen"
#&gt; Number of components: 3 
#&gt;        prob shift scale order ar_1 ar_2  ar_3
#&gt; Comp_1 0.3    5   2.0     2    0.5  0.24     
#&gt; Comp_2 0.3   -5   1.0     1   -0.9           
#&gt; Comp_3 0.4    0   0.5     3    1.5 -0.74 0.12
#&gt; 
#&gt; Distributions of the error components:
#&gt; 	Component 1: Student t with 4 df
#&gt; 	Component 2: Student t with 6 df
#&gt; 	Component 3: Student t with 10 df
#&gt; </div><div class='input'><span class='no'>moT_C2</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARgen"</span>
              , <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>exampleModels</span>$<span class='no'>WL_Bt_1</span>
              , <span class='kw'>dist</span> <span class='kw'>=</span> <span class='fu'><a href='fnoise.html'>distlist</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"stdt"</span>, <span class='st'>"stdt"</span>, <span class='st'>"stdnorm"</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>7</span>))  <span class='co'># t4, t7, N(0,1)</span>
              )
<span class='no'>moT_C3</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"MixARGaussian"</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>exampleModels</span>$<span class='no'>WL_Bt_1</span> )</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Georgi N. Boshnakov, Davide Ravagli.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


